---
// Página dinámica de tour individual en inglés
import Baselayout from '../../../layouts/Baselayout.astro';

export async function getStaticPaths() {
  const tours = (await import('../../../data/tours.en.json')).default;
  return tours.map(tour => ({ params: { slug: tour.slug } }));
}

const { slug } = Astro.params;
const tours = (await import('../../../data/tours.en.json')).default;
const tour = tours.find(t => t.slug === slug);

if (!tour) {
  throw new Error('Tour not found');
}

// Aquí creamos props personalizados en variables
const lang = 'en';
const seo = {
  title: `${tour.name} | Agencia Cusco`,
  description: tour.description,
  hreflangs: [
    { lang: 'en', url: `/tours/${slug}` },
    { lang: 'es', url: `/es/tours/${slug}` }
  ]
};
---
<Baselayout lang={lang} seo={seo}>
  <section class="max-w-3xl mx-auto py-10 px-4">
    {tour.images && tour.images.length > 0 && (
      <div class="mb-8">
        <div class="grid grid-cols-2 gap-2 md:grid-cols-4 masonry-grid">
          <div class="col-span-2 row-span-2">
            <img src={tour.images[0]} alt={tour.name + ' 1'} class="rounded-xl w-full h-64 object-cover" loading="lazy" />
          </div>
          <div>
            <img src={tour.images[1]} alt={tour.name + ' 2'} class="rounded-xl w-full h-32 object-cover" loading="lazy" />
          </div>
          <div>
            <img src={tour.images[2]} alt={tour.name + ' 3'} class="rounded-xl w-full h-32 object-cover" loading="lazy" />
          </div>
          <div class="col-span-2">
            <img src={tour.images[3]} alt={tour.name + ' 4'} class="rounded-xl w-full h-40 object-cover" loading="lazy" />
          </div>
        </div>
      </div>
    )}
    <div class="flex flex-col md:flex-row gap-8 items-center md:items-start">
      <img src={tour.image} alt={tour.name} class="w-full md:w-80 rounded-xl shadow-lg border-2 border-[#d2a530] bg-white" loading="lazy" />
      <div class="flex-1">
        <h1 class="text-3xl md:text-4xl font-extrabold text-[#b64926] mb-2">{tour.name}</h1>
        <span class="inline-block bg-[#d2a530] text-white px-3 py-1 rounded-lg font-bold text-lg mb-2">${tour.price}</span>
        <p class="text-[#372212] text-lg mb-4">{tour.description}</p>
        <div class="mb-4">
          <span class="font-semibold text-[#b64926]">Duration:</span> {tour.duration}
        </div>
        <div class="mb-4">
          <span class="font-semibold text-[#b64926]">Includes:</span>
          <ul class="list-disc list-inside text-[#372212]">
            {tour.includes.map(item => <li>{item}</li>)}
          </ul>
        </div>
        <div class="flex gap-4 mt-4">
          <a href="/tours" class="text-[#b64926] underline hover:text-[#d2a530]">← Back to tours</a>
        </div>
      </div>
    </div>
  </section>
</Baselayout>

<style>
.masonry-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-auto-rows: 1fr;
}
@media (min-width: 768px) {
  .masonry-grid {
    grid-template-columns: repeat(4, 1fr);
  }
}
</style>

